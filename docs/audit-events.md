# Audit Events Definition for MCP Audit Proxy
（MCP Audit Proxy における監査イベント定義）


## 1. このドキュメントの目的

### Purpose of This Document

### 日本語

本ドキュメントは、**MCP Audit Proxy** が生成する
**監査イベント（Audit Events）** の粒度・意味・責任範囲を明確に定義することを目的とします。

本設計は、以下を満たすことを目標としています。

* 事後監査・法務調査に耐えうる説明可能性（Accountability）
* AI 利用における行為の追跡可能性（Traceability）
* 否認・改ざんを技術的に不可能にする証跡設計

### English

This document defines the **audit event model** generated by the MCP Audit Proxy,
clarifying event granularity, semantics, and accountability boundaries.

The design aims to achieve:

* Legal-grade accountability
* End-to-end traceability of AI-mediated actions
* Technical non-repudiation through tamper-evident logs


## 2. 基本原則（Design Principles）

### Core Design Principles

### 日本語

監査イベント設計は、以下の原則に基づきます。

1. **イベント = 責任が確定する瞬間**
2. 通信の途中経過すべてを記録しない
3. 後から「なかったことにできない点」だけを残す
4. 最小だが十分な粒度を維持する

### English

Audit events are designed based on the following principles:

1. **An event represents a moment of accountability**
2. Not every transport-level step is logged
3. Only non-deniable facts are recorded
4. The model is minimal yet legally sufficient


## 3. 1リクエストとイベントの関係

### Event Model per Request

### 日本語

**1つの MCP リクエスト（1ツール呼び出し）** は、
**1つの trace_id** によって束ねられ、
最大 **5つの監査イベント** を生成します。

```
1 trace_id = 1 意思決定行為
```

### English

A **single MCP request (tool invocation)** is bound by one `trace_id`
and produces up to **five audit events**.

```
1 trace_id = 1 decision-making action
```



## 4. 標準イベント一覧

### Standard Audit Events

| event_seq | event_type               | 日本語の意味    | English Meaning         |
| --------- | ------------------------ | --------- | ----------------------- |
| 1         | request_received         | 要求を受信した   | Request received        |
| 2         | server_forwarded         | 外部MCPへ転送  | Forwarded to MCP server |
| 3         | server_response_received | 応答を受信     | Response received       |
| 4         | response_sent            | クライアントへ返却 | Response sent           |
| 5         | error                    | 処理失敗      | Error occurred          |

※ `error` は成功時には発生しません。



## 5. 各イベントの定義

### Event Definitions


### 5.1 request_received

#### 日本語

**意味**
MCP Client からの要求を Proxy が正式に受理したことを示します。

**責任上の意味**

* 「その要求は存在した」ことの証明
* この時点から処理責任は Proxy 側に移行

**実通信上の対応**

* stdio / HTTP 経由で JSON-RPC Request を受信した瞬間

#### English

**Meaning**
Indicates that the Proxy has officially accepted a request from the MCP Client.

**Accountability**

* Proof that the request existed
* Processing responsibility transfers to the Proxy

**Mapped to Transport**

* Moment when a JSON-RPC request is received via stdio or HTTP


### 5.2 server_forwarded

#### 日本語

**意味**
Proxy がリクエストを **実際の MCP Server** に送信したことを示します。

**責任上の意味**

* データが組織外／別システムに出た事実の証明

**注意**

* 内部ツールのみの場合、省略可能

#### English

**Meaning**
Indicates that the Proxy forwarded the request to the real MCP Server.

**Accountability**

* Proof that data left the Proxy boundary

**Note**

* Optional for internal-only deployments


### 5.3 server_response_received

#### 日本語

**意味**
MCP Server からの応答を Proxy が受信したことを示します。

**責任上の意味**

* マスキング前のデータが存在した証明
* まだ AI には渡っていない

#### English

**Meaning**
Indicates that the Proxy received a response from the MCP Server.

**Accountability**

* Proof that original data existed
* Data has not yet been exposed to the AI client



### 5.4 response_sent（最終責任点）

### response_sent (Final Accountability Point)

#### 日本語

**意味**
Proxy が MCP Client（AI）へ応答を返却したことを示します。

**責任上の意味**

* この瞬間に情報提供が確定
* 成功時の**最終責任点**

#### English

**Meaning**
Indicates that the Proxy returned a response to the MCP Client (AI).

**Accountability**

* Information disclosure is finalized
* Final accountability point for successful requests



### 5.5 error（失敗時の最終責任点）

### error (Failure Accountability Point)

#### 日本語

**意味**
処理が正常に完了しなかったことを示します。

**責任上の意味**

* 情報が渡っていないことの証明
* 隠蔽防止のため必須

#### English

**Meaning**
Indicates that processing did not complete successfully.

**Accountability**

* Proof that no data was delivered
* Required to prevent silent failure or concealment



## 6. イベントと実通信の対応関係

### Mapping to MCP Communication

| Event                    | MCP Communication Phase |
| ------------------------ | ----------------------- |
| request_received         | Client → Proxy          |
| server_forwarded         | Proxy → MCP Server      |
| server_response_received | MCP Server → Proxy      |
| response_sent            | Proxy → Client          |
| error                    | Any phase               |

---

## 7. チェーンに含めるイベント

### Events Included in the Hash Chain

### 日本語

**最低限（必須）**

* request_received
* response_sent
* error

**推奨（企業・監査向け）**

* server_forwarded
* server_response_received

### English

**Minimum (Required)**

* request_received
* response_sent
* error

**Recommended (Enterprise / Audit-grade)**

* server_forwarded
* server_response_received



## 8. なぜこの粒度なのか

### Why This Granularity

### 日本語

* 少なすぎる → 説明不能
* 多すぎる → 監査が読まない
* **5イベントは「説明可能な最小構成」**

### English

* Too few → Not explainable
* Too many → Unreadable for auditors
* **Five events represent the minimum explainable model**



## 9. 一文での定義

### One-Sentence Definition

### 日本語

> 監査イベントとは「後から否定されたら困る瞬間」を
> 順序付き・改ざん不能に記録したものである。

### English

> An audit event is a tamper-evident, ordered record
> of moments that must never be denied later.

